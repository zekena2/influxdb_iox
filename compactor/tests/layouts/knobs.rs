//! Module for testing / demonstrating how configuration parameters
//! (knobs) affect the compactor output.
//!
//! See [crate::layout] module for detailed documentation

use crate::layouts::{all_overlapping_l0_files, layout_setup_builder, run_layout_scenario, ONE_MB};

/// This test show the effects of the split_percentage parameter
#[tokio::test]
async fn all_overlapping_l0_split_percentage() {
    test_helpers::maybe_start_logging();

    //
    // configure to leave a smaller part of  data on the leading
    // edge.
    //
    // Expect to see two output files, one having the oldest 95
    // percent of the data, and one having the newest 5 percent.
    let setup = layout_setup_builder()
        .await
        .with_split_percentage(95)
        .build()
        .await;

    // create virtual files
    let setup = all_overlapping_l0_files(setup).await;

    insta::assert_yaml_snapshot!(
        run_layout_scenario(&setup).await,
        @r###"
    ---
    - "**** Input Files "
    - "L0, all files 9mb                                                                                                  "
    - "L0.1[100,200000] 1ns     |-----------------------------------------L0.1------------------------------------------| "
    - "L0.2[100,200000] 2ns     |-----------------------------------------L0.2------------------------------------------| "
    - "L0.3[100,200000] 3ns     |-----------------------------------------L0.3------------------------------------------| "
    - "L0.4[100,200000] 4ns     |-----------------------------------------L0.4------------------------------------------| "
    - "L0.5[100,200000] 5ns     |-----------------------------------------L0.5------------------------------------------| "
    - "L0.6[100,200000] 6ns     |-----------------------------------------L0.6------------------------------------------| "
    - "L0.7[100,200000] 7ns     |-----------------------------------------L0.7------------------------------------------| "
    - "L0.8[100,200000] 8ns     |-----------------------------------------L0.8------------------------------------------| "
    - "L0.9[100,200000] 9ns     |-----------------------------------------L0.9------------------------------------------| "
    - "L0.10[100,200000] 10ns   |-----------------------------------------L0.10-----------------------------------------| "
    - "**** Simulation run 0, type=split(CompactAndSplitOutput(TotalSizeLessThanMaxCompactSize))(split_times=[190005]). 10 Input Files, 90mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.10[100,200000] 10ns   |-----------------------------------------L0.10-----------------------------------------| "
    - "L0.9[100,200000] 9ns     |-----------------------------------------L0.9------------------------------------------| "
    - "L0.8[100,200000] 8ns     |-----------------------------------------L0.8------------------------------------------| "
    - "L0.7[100,200000] 7ns     |-----------------------------------------L0.7------------------------------------------| "
    - "L0.6[100,200000] 6ns     |-----------------------------------------L0.6------------------------------------------| "
    - "L0.5[100,200000] 5ns     |-----------------------------------------L0.5------------------------------------------| "
    - "L0.4[100,200000] 4ns     |-----------------------------------------L0.4------------------------------------------| "
    - "L0.3[100,200000] 3ns     |-----------------------------------------L0.3------------------------------------------| "
    - "L0.2[100,200000] 2ns     |-----------------------------------------L0.2------------------------------------------| "
    - "L0.1[100,200000] 1ns     |-----------------------------------------L0.1------------------------------------------| "
    - "**** 2 Output Files (parquet_file_id not yet assigned), 90mb total:"
    - "L1                                                                                                                 "
    - "L1.?[100,190005] 10ns 86mb|---------------------------------------L1.?----------------------------------------|     "
    - "L1.?[190006,200000] 10ns 4mb                                                                                     |L1.?|"
    - "Committing partition 1:"
    - "  Soft Deleting 10 files: L0.1, L0.2, L0.3, L0.4, L0.5, L0.6, L0.7, L0.8, L0.9, L0.10"
    - "  Creating 2 files"
    - "**** Final Output Files (90mb written)"
    - "L1                                                                                                                 "
    - "L1.11[100,190005] 10ns 86mb|---------------------------------------L1.11---------------------------------------|     "
    - "L1.12[190006,200000] 10ns 4mb                                                                                     |L1.12|"
    "###
    );
}

/// This test show the effects of the percentage_max_file_size parameter
#[tokio::test]
async fn all_overlapping_l0_max_file_size() {
    test_helpers::maybe_start_logging();

    //
    // configure the max file size percentage to be 95%
    //
    // This means that the compactor will only apply the "leading
    // edge" optimization for data that is greater than 95 * 100MB =
    // 95MB in total
    //
    // Expect to see a single output file
    let setup = layout_setup_builder()
        .await
        .with_percentage_max_file_size(95)
        .build()
        .await;

    // create virtual files
    let setup = all_overlapping_l0_files(setup).await;

    insta::assert_yaml_snapshot!(
        run_layout_scenario(&setup).await,
        @r###"
    ---
    - "**** Input Files "
    - "L0, all files 9mb                                                                                                  "
    - "L0.1[100,200000] 1ns     |-----------------------------------------L0.1------------------------------------------| "
    - "L0.2[100,200000] 2ns     |-----------------------------------------L0.2------------------------------------------| "
    - "L0.3[100,200000] 3ns     |-----------------------------------------L0.3------------------------------------------| "
    - "L0.4[100,200000] 4ns     |-----------------------------------------L0.4------------------------------------------| "
    - "L0.5[100,200000] 5ns     |-----------------------------------------L0.5------------------------------------------| "
    - "L0.6[100,200000] 6ns     |-----------------------------------------L0.6------------------------------------------| "
    - "L0.7[100,200000] 7ns     |-----------------------------------------L0.7------------------------------------------| "
    - "L0.8[100,200000] 8ns     |-----------------------------------------L0.8------------------------------------------| "
    - "L0.9[100,200000] 9ns     |-----------------------------------------L0.9------------------------------------------| "
    - "L0.10[100,200000] 10ns   |-----------------------------------------L0.10-----------------------------------------| "
    - "**** Simulation run 0, type=compact(TotalSizeLessThanMaxCompactSize). 10 Input Files, 90mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.10[100,200000] 10ns   |-----------------------------------------L0.10-----------------------------------------| "
    - "L0.9[100,200000] 9ns     |-----------------------------------------L0.9------------------------------------------| "
    - "L0.8[100,200000] 8ns     |-----------------------------------------L0.8------------------------------------------| "
    - "L0.7[100,200000] 7ns     |-----------------------------------------L0.7------------------------------------------| "
    - "L0.6[100,200000] 6ns     |-----------------------------------------L0.6------------------------------------------| "
    - "L0.5[100,200000] 5ns     |-----------------------------------------L0.5------------------------------------------| "
    - "L0.4[100,200000] 4ns     |-----------------------------------------L0.4------------------------------------------| "
    - "L0.3[100,200000] 3ns     |-----------------------------------------L0.3------------------------------------------| "
    - "L0.2[100,200000] 2ns     |-----------------------------------------L0.2------------------------------------------| "
    - "L0.1[100,200000] 1ns     |-----------------------------------------L0.1------------------------------------------| "
    - "**** 1 Output Files (parquet_file_id not yet assigned), 90mb total:"
    - "L1, all files 90mb                                                                                                 "
    - "L1.?[100,200000] 10ns    |-----------------------------------------L1.?------------------------------------------| "
    - "Committing partition 1:"
    - "  Soft Deleting 10 files: L0.1, L0.2, L0.3, L0.4, L0.5, L0.6, L0.7, L0.8, L0.9, L0.10"
    - "  Creating 1 files"
    - "**** Final Output Files (90mb written)"
    - "L1, all files 90mb                                                                                                 "
    - "L1.11[100,200000] 10ns   |-----------------------------------------L1.11-----------------------------------------| "
    "###
    );
}

/// This test show how the split percentage and max_file size ineract
#[tokio::test]
async fn all_overlapping_l0_split_percentage_and_max_file_size() {
    test_helpers::maybe_start_logging();

    // configure the max file size percentage to be 95% and the max file size to be 10MB
    //
    // This means that the compactor will only apply the "leading
    // edge" optimization for data that is greater than 95 * 10MB =
    // 9.5 MB in total
    //
    // Expect to see 2 ~40mb files, 1 file that is smaller
    let setup = layout_setup_builder()
        .await
        .with_max_desired_file_size_bytes(40 * ONE_MB)
        .with_percentage_max_file_size(95)
        .build()
        .await;

    // create virtual files
    let setup = all_overlapping_l0_files(setup).await;

    insta::assert_yaml_snapshot!(
        run_layout_scenario(&setup).await,
        @r###"
    ---
    - "**** Input Files "
    - "L0, all files 9mb                                                                                                  "
    - "L0.1[100,200000] 1ns     |-----------------------------------------L0.1------------------------------------------| "
    - "L0.2[100,200000] 2ns     |-----------------------------------------L0.2------------------------------------------| "
    - "L0.3[100,200000] 3ns     |-----------------------------------------L0.3------------------------------------------| "
    - "L0.4[100,200000] 4ns     |-----------------------------------------L0.4------------------------------------------| "
    - "L0.5[100,200000] 5ns     |-----------------------------------------L0.5------------------------------------------| "
    - "L0.6[100,200000] 6ns     |-----------------------------------------L0.6------------------------------------------| "
    - "L0.7[100,200000] 7ns     |-----------------------------------------L0.7------------------------------------------| "
    - "L0.8[100,200000] 8ns     |-----------------------------------------L0.8------------------------------------------| "
    - "L0.9[100,200000] 9ns     |-----------------------------------------L0.9------------------------------------------| "
    - "L0.10[100,200000] 10ns   |-----------------------------------------L0.10-----------------------------------------| "
    - "**** Simulation run 0, type=split(CompactAndSplitOutput(TotalSizeLessThanMaxCompactSize))(split_times=[88945, 177790]). 10 Input Files, 90mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.10[100,200000] 10ns   |-----------------------------------------L0.10-----------------------------------------| "
    - "L0.9[100,200000] 9ns     |-----------------------------------------L0.9------------------------------------------| "
    - "L0.8[100,200000] 8ns     |-----------------------------------------L0.8------------------------------------------| "
    - "L0.7[100,200000] 7ns     |-----------------------------------------L0.7------------------------------------------| "
    - "L0.6[100,200000] 6ns     |-----------------------------------------L0.6------------------------------------------| "
    - "L0.5[100,200000] 5ns     |-----------------------------------------L0.5------------------------------------------| "
    - "L0.4[100,200000] 4ns     |-----------------------------------------L0.4------------------------------------------| "
    - "L0.3[100,200000] 3ns     |-----------------------------------------L0.3------------------------------------------| "
    - "L0.2[100,200000] 2ns     |-----------------------------------------L0.2------------------------------------------| "
    - "L0.1[100,200000] 1ns     |-----------------------------------------L0.1------------------------------------------| "
    - "**** 3 Output Files (parquet_file_id not yet assigned), 90mb total:"
    - "L1                                                                                                                 "
    - "L1.?[100,88945] 10ns 40mb|-----------------L1.?-----------------|                                                  "
    - "L1.?[88946,177790] 10ns 40mb                                        |----------------L1.?-----------------|           "
    - "L1.?[177791,200000] 10ns 10mb                                                                                |-L1.?--| "
    - "Committing partition 1:"
    - "  Soft Deleting 10 files: L0.1, L0.2, L0.3, L0.4, L0.5, L0.6, L0.7, L0.8, L0.9, L0.10"
    - "  Creating 3 files"
    - "**** Simulation run 1, type=compact(TotalSizeLessThanMaxCompactSize). 1 Input Files, 10mb total:"
    - "L1, all files 10mb                                                                                                 "
    - "L1.13[177791,200000] 10ns|-----------------------------------------L1.13------------------------------------------|"
    - "**** 1 Output Files (parquet_file_id not yet assigned), 10mb total:"
    - "L2, all files 10mb                                                                                                 "
    - "L2.?[177791,200000] 10ns |------------------------------------------L2.?------------------------------------------|"
    - "Committing partition 1:"
    - "  Soft Deleting 1 files: L1.13"
    - "  Upgrading 2 files level to CompactionLevel::L2: L1.11, L1.12"
    - "  Creating 1 files"
    - "**** Final Output Files (100mb written)"
    - "L2                                                                                                                 "
    - "L2.11[100,88945] 10ns 40mb|----------------L2.11-----------------|                                                  "
    - "L2.12[88946,177790] 10ns 40mb                                        |----------------L2.12----------------|           "
    - "L2.14[177791,200000] 10ns 10mb                                                                                |-L2.14-| "
    "###
    );
}

/// This test show how the max_num_files_per_plan setting works
#[tokio::test]
async fn all_overlapping_l0_max_num_files_per_plan() {
    test_helpers::maybe_start_logging();

    // configure the max num files per plan to 3
    let setup = layout_setup_builder()
        .await
        .with_max_num_files_per_plan(3)
        .build()
        .await;

    // create virtual files
    let setup = all_overlapping_l0_files(setup).await;

    // expect that each plan the compactor runs has at most three input files
    insta::assert_yaml_snapshot!(
        run_layout_scenario(&setup).await,
        @r###"
    ---
    - "**** Input Files "
    - "L0, all files 9mb                                                                                                  "
    - "L0.1[100,200000] 1ns     |-----------------------------------------L0.1------------------------------------------| "
    - "L0.2[100,200000] 2ns     |-----------------------------------------L0.2------------------------------------------| "
    - "L0.3[100,200000] 3ns     |-----------------------------------------L0.3------------------------------------------| "
    - "L0.4[100,200000] 4ns     |-----------------------------------------L0.4------------------------------------------| "
    - "L0.5[100,200000] 5ns     |-----------------------------------------L0.5------------------------------------------| "
    - "L0.6[100,200000] 6ns     |-----------------------------------------L0.6------------------------------------------| "
    - "L0.7[100,200000] 7ns     |-----------------------------------------L0.7------------------------------------------| "
    - "L0.8[100,200000] 8ns     |-----------------------------------------L0.8------------------------------------------| "
    - "L0.9[100,200000] 9ns     |-----------------------------------------L0.9------------------------------------------| "
    - "L0.10[100,200000] 10ns   |-----------------------------------------L0.10-----------------------------------------| "
    - "**** Simulation run 0, type=compact(ManySmallFiles). 3 Input Files, 27mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.1[100,200000] 1ns     |-----------------------------------------L0.1------------------------------------------| "
    - "L0.2[100,200000] 2ns     |-----------------------------------------L0.2------------------------------------------| "
    - "L0.3[100,200000] 3ns     |-----------------------------------------L0.3------------------------------------------| "
    - "**** 1 Output Files (parquet_file_id not yet assigned), 27mb total:"
    - "L0, all files 27mb                                                                                                 "
    - "L0.?[100,200000] 3ns     |-----------------------------------------L0.?------------------------------------------| "
    - "Committing partition 1:"
    - "  Soft Deleting 3 files: L0.1, L0.2, L0.3"
    - "  Creating 1 files"
    - "**** Simulation run 1, type=compact(ManySmallFiles). 3 Input Files, 27mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.4[100,200000] 4ns     |-----------------------------------------L0.4------------------------------------------| "
    - "L0.5[100,200000] 5ns     |-----------------------------------------L0.5------------------------------------------| "
    - "L0.6[100,200000] 6ns     |-----------------------------------------L0.6------------------------------------------| "
    - "**** 1 Output Files (parquet_file_id not yet assigned), 27mb total:"
    - "L0, all files 27mb                                                                                                 "
    - "L0.?[100,200000] 6ns     |-----------------------------------------L0.?------------------------------------------| "
    - "Committing partition 1:"
    - "  Soft Deleting 3 files: L0.4, L0.5, L0.6"
    - "  Creating 1 files"
    - "**** Simulation run 2, type=compact(ManySmallFiles). 3 Input Files, 27mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.7[100,200000] 7ns     |-----------------------------------------L0.7------------------------------------------| "
    - "L0.8[100,200000] 8ns     |-----------------------------------------L0.8------------------------------------------| "
    - "L0.9[100,200000] 9ns     |-----------------------------------------L0.9------------------------------------------| "
    - "**** 1 Output Files (parquet_file_id not yet assigned), 27mb total:"
    - "L0, all files 27mb                                                                                                 "
    - "L0.?[100,200000] 9ns     |-----------------------------------------L0.?------------------------------------------| "
    - "Committing partition 1:"
    - "  Soft Deleting 3 files: L0.7, L0.8, L0.9"
    - "  Creating 1 files"
    - "**** Simulation run 3, type=compact(ManySmallFiles). 3 Input Files, 81mb total:"
    - "L0, all files 27mb                                                                                                 "
    - "L0.11[100,200000] 3ns    |-----------------------------------------L0.11-----------------------------------------| "
    - "L0.12[100,200000] 6ns    |-----------------------------------------L0.12-----------------------------------------| "
    - "L0.13[100,200000] 9ns    |-----------------------------------------L0.13-----------------------------------------| "
    - "**** 1 Output Files (parquet_file_id not yet assigned), 81mb total:"
    - "L0, all files 81mb                                                                                                 "
    - "L0.?[100,200000] 9ns     |-----------------------------------------L0.?------------------------------------------| "
    - "Committing partition 1:"
    - "  Soft Deleting 3 files: L0.11, L0.12, L0.13"
    - "  Creating 1 files"
    - "**** Simulation run 4, type=split(CompactAndSplitOutput(TotalSizeLessThanMaxCompactSize))(split_times=[160020]). 2 Input Files, 90mb total:"
    - "L0                                                                                                                 "
    - "L0.14[100,200000] 9ns 81mb|-----------------------------------------L0.14-----------------------------------------| "
    - "L0.10[100,200000] 10ns 9mb|-----------------------------------------L0.10-----------------------------------------| "
    - "**** 2 Output Files (parquet_file_id not yet assigned), 90mb total:"
    - "L1                                                                                                                 "
    - "L1.?[100,160020] 10ns 72mb|---------------------------------L1.?---------------------------------|                  "
    - "L1.?[160021,200000] 10ns 18mb                                                                        |-----L1.?------| "
    - "Committing partition 1:"
    - "  Soft Deleting 2 files: L0.10, L0.14"
    - "  Creating 2 files"
    - "**** Final Output Files (252mb written)"
    - "L1                                                                                                                 "
    - "L1.15[100,160020] 10ns 72mb|--------------------------------L1.15---------------------------------|                  "
    - "L1.16[160021,200000] 10ns 18mb                                                                        |-----L1.16-----| "
    "###
    );
}

#[tokio::test]
async fn all_overlapping_l0_max_input_bytes_per_partition() {
    test_helpers::maybe_start_logging();

    let setup = layout_setup_builder()
        .await
        .with_max_desired_file_size_bytes(10 * ONE_MB)
        .build()
        .await;

    // create virtual files
    let setup = all_overlapping_l0_files(setup).await;

    // expect that each plan the compactor runs has at most three input files
    insta::assert_yaml_snapshot!(
        run_layout_scenario(&setup).await,
        @r###"
    ---
    - "**** Input Files "
    - "L0, all files 9mb                                                                                                  "
    - "L0.1[100,200000] 1ns     |-----------------------------------------L0.1------------------------------------------| "
    - "L0.2[100,200000] 2ns     |-----------------------------------------L0.2------------------------------------------| "
    - "L0.3[100,200000] 3ns     |-----------------------------------------L0.3------------------------------------------| "
    - "L0.4[100,200000] 4ns     |-----------------------------------------L0.4------------------------------------------| "
    - "L0.5[100,200000] 5ns     |-----------------------------------------L0.5------------------------------------------| "
    - "L0.6[100,200000] 6ns     |-----------------------------------------L0.6------------------------------------------| "
    - "L0.7[100,200000] 7ns     |-----------------------------------------L0.7------------------------------------------| "
    - "L0.8[100,200000] 8ns     |-----------------------------------------L0.8------------------------------------------| "
    - "L0.9[100,200000] 9ns     |-----------------------------------------L0.9------------------------------------------| "
    - "L0.10[100,200000] 10ns   |-----------------------------------------L0.10-----------------------------------------| "
    - "**** Simulation run 0, type=split(VerticalSplit)(split_times=[28656, 57212, 85768, 114324, 142880, 171436]). 1 Input Files, 9mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.1[100,200000] 1ns     |-----------------------------------------L0.1------------------------------------------| "
    - "**** 7 Output Files (parquet_file_id not yet assigned), 9mb total:"
    - "L0                                                                                                                 "
    - "L0.?[100,28656] 1ns 1mb  |---L0.?---|                                                                              "
    - "L0.?[28657,57212] 1ns 1mb            |---L0.?---|                                                                  "
    - "L0.?[57213,85768] 1ns 1mb                         |---L0.?---|                                                     "
    - "L0.?[85769,114324] 1ns 1mb                                      |---L0.?---|                                        "
    - "L0.?[114325,142880] 1ns 1mb                                                   |---L0.?---|                           "
    - "L0.?[142881,171436] 1ns 1mb                                                                |---L0.?---|              "
    - "L0.?[171437,200000] 1ns 1mb                                                                             |---L0.?---| "
    - "**** Simulation run 1, type=split(VerticalSplit)(split_times=[28656, 57212, 85768, 114324, 142880, 171436]). 1 Input Files, 9mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.2[100,200000] 2ns     |-----------------------------------------L0.2------------------------------------------| "
    - "**** 7 Output Files (parquet_file_id not yet assigned), 9mb total:"
    - "L0                                                                                                                 "
    - "L0.?[100,28656] 2ns 1mb  |---L0.?---|                                                                              "
    - "L0.?[28657,57212] 2ns 1mb            |---L0.?---|                                                                  "
    - "L0.?[57213,85768] 2ns 1mb                         |---L0.?---|                                                     "
    - "L0.?[85769,114324] 2ns 1mb                                      |---L0.?---|                                        "
    - "L0.?[114325,142880] 2ns 1mb                                                   |---L0.?---|                           "
    - "L0.?[142881,171436] 2ns 1mb                                                                |---L0.?---|              "
    - "L0.?[171437,200000] 2ns 1mb                                                                             |---L0.?---| "
    - "**** Simulation run 2, type=split(VerticalSplit)(split_times=[28656, 57212, 85768, 114324, 142880, 171436]). 1 Input Files, 9mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.3[100,200000] 3ns     |-----------------------------------------L0.3------------------------------------------| "
    - "**** 7 Output Files (parquet_file_id not yet assigned), 9mb total:"
    - "L0                                                                                                                 "
    - "L0.?[100,28656] 3ns 1mb  |---L0.?---|                                                                              "
    - "L0.?[28657,57212] 3ns 1mb            |---L0.?---|                                                                  "
    - "L0.?[57213,85768] 3ns 1mb                         |---L0.?---|                                                     "
    - "L0.?[85769,114324] 3ns 1mb                                      |---L0.?---|                                        "
    - "L0.?[114325,142880] 3ns 1mb                                                   |---L0.?---|                           "
    - "L0.?[142881,171436] 3ns 1mb                                                                |---L0.?---|              "
    - "L0.?[171437,200000] 3ns 1mb                                                                             |---L0.?---| "
    - "**** Simulation run 3, type=split(VerticalSplit)(split_times=[28656, 57212, 85768, 114324, 142880, 171436]). 1 Input Files, 9mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.4[100,200000] 4ns     |-----------------------------------------L0.4------------------------------------------| "
    - "**** 7 Output Files (parquet_file_id not yet assigned), 9mb total:"
    - "L0                                                                                                                 "
    - "L0.?[100,28656] 4ns 1mb  |---L0.?---|                                                                              "
    - "L0.?[28657,57212] 4ns 1mb            |---L0.?---|                                                                  "
    - "L0.?[57213,85768] 4ns 1mb                         |---L0.?---|                                                     "
    - "L0.?[85769,114324] 4ns 1mb                                      |---L0.?---|                                        "
    - "L0.?[114325,142880] 4ns 1mb                                                   |---L0.?---|                           "
    - "L0.?[142881,171436] 4ns 1mb                                                                |---L0.?---|              "
    - "L0.?[171437,200000] 4ns 1mb                                                                             |---L0.?---| "
    - "**** Simulation run 4, type=split(VerticalSplit)(split_times=[28656, 57212, 85768, 114324, 142880, 171436]). 1 Input Files, 9mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.5[100,200000] 5ns     |-----------------------------------------L0.5------------------------------------------| "
    - "**** 7 Output Files (parquet_file_id not yet assigned), 9mb total:"
    - "L0                                                                                                                 "
    - "L0.?[100,28656] 5ns 1mb  |---L0.?---|                                                                              "
    - "L0.?[28657,57212] 5ns 1mb            |---L0.?---|                                                                  "
    - "L0.?[57213,85768] 5ns 1mb                         |---L0.?---|                                                     "
    - "L0.?[85769,114324] 5ns 1mb                                      |---L0.?---|                                        "
    - "L0.?[114325,142880] 5ns 1mb                                                   |---L0.?---|                           "
    - "L0.?[142881,171436] 5ns 1mb                                                                |---L0.?---|              "
    - "L0.?[171437,200000] 5ns 1mb                                                                             |---L0.?---| "
    - "**** Simulation run 5, type=split(VerticalSplit)(split_times=[28656, 57212, 85768, 114324, 142880, 171436]). 1 Input Files, 9mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.6[100,200000] 6ns     |-----------------------------------------L0.6------------------------------------------| "
    - "**** 7 Output Files (parquet_file_id not yet assigned), 9mb total:"
    - "L0                                                                                                                 "
    - "L0.?[100,28656] 6ns 1mb  |---L0.?---|                                                                              "
    - "L0.?[28657,57212] 6ns 1mb            |---L0.?---|                                                                  "
    - "L0.?[57213,85768] 6ns 1mb                         |---L0.?---|                                                     "
    - "L0.?[85769,114324] 6ns 1mb                                      |---L0.?---|                                        "
    - "L0.?[114325,142880] 6ns 1mb                                                   |---L0.?---|                           "
    - "L0.?[142881,171436] 6ns 1mb                                                                |---L0.?---|              "
    - "L0.?[171437,200000] 6ns 1mb                                                                             |---L0.?---| "
    - "**** Simulation run 6, type=split(VerticalSplit)(split_times=[28656, 57212, 85768, 114324, 142880, 171436]). 1 Input Files, 9mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.7[100,200000] 7ns     |-----------------------------------------L0.7------------------------------------------| "
    - "**** 7 Output Files (parquet_file_id not yet assigned), 9mb total:"
    - "L0                                                                                                                 "
    - "L0.?[100,28656] 7ns 1mb  |---L0.?---|                                                                              "
    - "L0.?[28657,57212] 7ns 1mb            |---L0.?---|                                                                  "
    - "L0.?[57213,85768] 7ns 1mb                         |---L0.?---|                                                     "
    - "L0.?[85769,114324] 7ns 1mb                                      |---L0.?---|                                        "
    - "L0.?[114325,142880] 7ns 1mb                                                   |---L0.?---|                           "
    - "L0.?[142881,171436] 7ns 1mb                                                                |---L0.?---|              "
    - "L0.?[171437,200000] 7ns 1mb                                                                             |---L0.?---| "
    - "**** Simulation run 7, type=split(VerticalSplit)(split_times=[28656, 57212, 85768, 114324, 142880, 171436]). 1 Input Files, 9mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.8[100,200000] 8ns     |-----------------------------------------L0.8------------------------------------------| "
    - "**** 7 Output Files (parquet_file_id not yet assigned), 9mb total:"
    - "L0                                                                                                                 "
    - "L0.?[100,28656] 8ns 1mb  |---L0.?---|                                                                              "
    - "L0.?[28657,57212] 8ns 1mb            |---L0.?---|                                                                  "
    - "L0.?[57213,85768] 8ns 1mb                         |---L0.?---|                                                     "
    - "L0.?[85769,114324] 8ns 1mb                                      |---L0.?---|                                        "
    - "L0.?[114325,142880] 8ns 1mb                                                   |---L0.?---|                           "
    - "L0.?[142881,171436] 8ns 1mb                                                                |---L0.?---|              "
    - "L0.?[171437,200000] 8ns 1mb                                                                             |---L0.?---| "
    - "**** Simulation run 8, type=split(VerticalSplit)(split_times=[28656, 57212, 85768, 114324, 142880, 171436]). 1 Input Files, 9mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.9[100,200000] 9ns     |-----------------------------------------L0.9------------------------------------------| "
    - "**** 7 Output Files (parquet_file_id not yet assigned), 9mb total:"
    - "L0                                                                                                                 "
    - "L0.?[100,28656] 9ns 1mb  |---L0.?---|                                                                              "
    - "L0.?[28657,57212] 9ns 1mb            |---L0.?---|                                                                  "
    - "L0.?[57213,85768] 9ns 1mb                         |---L0.?---|                                                     "
    - "L0.?[85769,114324] 9ns 1mb                                      |---L0.?---|                                        "
    - "L0.?[114325,142880] 9ns 1mb                                                   |---L0.?---|                           "
    - "L0.?[142881,171436] 9ns 1mb                                                                |---L0.?---|              "
    - "L0.?[171437,200000] 9ns 1mb                                                                             |---L0.?---| "
    - "**** Simulation run 9, type=split(VerticalSplit)(split_times=[28656, 57212, 85768, 114324, 142880, 171436]). 1 Input Files, 9mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.10[100,200000] 10ns   |-----------------------------------------L0.10-----------------------------------------| "
    - "**** 7 Output Files (parquet_file_id not yet assigned), 9mb total:"
    - "L0                                                                                                                 "
    - "L0.?[100,28656] 10ns 1mb |---L0.?---|                                                                              "
    - "L0.?[28657,57212] 10ns 1mb            |---L0.?---|                                                                  "
    - "L0.?[57213,85768] 10ns 1mb                         |---L0.?---|                                                     "
    - "L0.?[85769,114324] 10ns 1mb                                      |---L0.?---|                                        "
    - "L0.?[114325,142880] 10ns 1mb                                                   |---L0.?---|                           "
    - "L0.?[142881,171436] 10ns 1mb                                                                |---L0.?---|              "
    - "L0.?[171437,200000] 10ns 1mb                                                                             |---L0.?---| "
    - "Committing partition 1:"
    - "  Soft Deleting 10 files: L0.1, L0.2, L0.3, L0.4, L0.5, L0.6, L0.7, L0.8, L0.9, L0.10"
    - "  Creating 70 files"
    - "**** Simulation run 10, type=split(CompactAndSplitOutput(TotalSizeLessThanMaxCompactSize))(split_times=[22311]). 10 Input Files, 13mb total:"
    - "L0, all files 1mb                                                                                                  "
    - "L0.74[100,28656] 10ns    |-----------------------------------------L0.74------------------------------------------|"
    - "L0.67[100,28656] 9ns     |-----------------------------------------L0.67------------------------------------------|"
    - "L0.60[100,28656] 8ns     |-----------------------------------------L0.60------------------------------------------|"
    - "L0.53[100,28656] 7ns     |-----------------------------------------L0.53------------------------------------------|"
    - "L0.46[100,28656] 6ns     |-----------------------------------------L0.46------------------------------------------|"
    - "L0.39[100,28656] 5ns     |-----------------------------------------L0.39------------------------------------------|"
    - "L0.32[100,28656] 4ns     |-----------------------------------------L0.32------------------------------------------|"
    - "L0.25[100,28656] 3ns     |-----------------------------------------L0.25------------------------------------------|"
    - "L0.18[100,28656] 2ns     |-----------------------------------------L0.18------------------------------------------|"
    - "L0.11[100,28656] 1ns     |-----------------------------------------L0.11------------------------------------------|"
    - "**** 2 Output Files (parquet_file_id not yet assigned), 13mb total:"
    - "L1                                                                                                                 "
    - "L1.?[100,22311] 10ns 10mb|--------------------------------L1.?--------------------------------|                    "
    - "L1.?[22312,28656] 10ns 3mb                                                                      |------L1.?-------| "
    - "Committing partition 1:"
    - "  Soft Deleting 10 files: L0.11, L0.18, L0.25, L0.32, L0.39, L0.46, L0.53, L0.60, L0.67, L0.74"
    - "  Creating 2 files"
    - "**** Simulation run 11, type=split(CompactAndSplitOutput(TotalSizeLessThanMaxCompactSize))(split_times=[50868]). 10 Input Files, 13mb total:"
    - "L0, all files 1mb                                                                                                  "
    - "L0.75[28657,57212] 10ns  |-----------------------------------------L0.75------------------------------------------|"
    - "L0.68[28657,57212] 9ns   |-----------------------------------------L0.68------------------------------------------|"
    - "L0.61[28657,57212] 8ns   |-----------------------------------------L0.61------------------------------------------|"
    - "L0.54[28657,57212] 7ns   |-----------------------------------------L0.54------------------------------------------|"
    - "L0.47[28657,57212] 6ns   |-----------------------------------------L0.47------------------------------------------|"
    - "L0.40[28657,57212] 5ns   |-----------------------------------------L0.40------------------------------------------|"
    - "L0.33[28657,57212] 4ns   |-----------------------------------------L0.33------------------------------------------|"
    - "L0.26[28657,57212] 3ns   |-----------------------------------------L0.26------------------------------------------|"
    - "L0.19[28657,57212] 2ns   |-----------------------------------------L0.19------------------------------------------|"
    - "L0.12[28657,57212] 1ns   |-----------------------------------------L0.12------------------------------------------|"
    - "**** 2 Output Files (parquet_file_id not yet assigned), 13mb total:"
    - "L1                                                                                                                 "
    - "L1.?[28657,50868] 10ns 10mb|--------------------------------L1.?--------------------------------|                    "
    - "L1.?[50869,57212] 10ns 3mb                                                                      |------L1.?-------| "
    - "Committing partition 1:"
    - "  Soft Deleting 10 files: L0.12, L0.19, L0.26, L0.33, L0.40, L0.47, L0.54, L0.61, L0.68, L0.75"
    - "  Creating 2 files"
    - "**** Simulation run 12, type=split(CompactAndSplitOutput(TotalSizeLessThanMaxCompactSize))(split_times=[79424]). 10 Input Files, 13mb total:"
    - "L0, all files 1mb                                                                                                  "
    - "L0.76[57213,85768] 10ns  |-----------------------------------------L0.76------------------------------------------|"
    - "L0.69[57213,85768] 9ns   |-----------------------------------------L0.69------------------------------------------|"
    - "L0.62[57213,85768] 8ns   |-----------------------------------------L0.62------------------------------------------|"
    - "L0.55[57213,85768] 7ns   |-----------------------------------------L0.55------------------------------------------|"
    - "L0.48[57213,85768] 6ns   |-----------------------------------------L0.48------------------------------------------|"
    - "L0.41[57213,85768] 5ns   |-----------------------------------------L0.41------------------------------------------|"
    - "L0.34[57213,85768] 4ns   |-----------------------------------------L0.34------------------------------------------|"
    - "L0.27[57213,85768] 3ns   |-----------------------------------------L0.27------------------------------------------|"
    - "L0.20[57213,85768] 2ns   |-----------------------------------------L0.20------------------------------------------|"
    - "L0.13[57213,85768] 1ns   |-----------------------------------------L0.13------------------------------------------|"
    - "**** 2 Output Files (parquet_file_id not yet assigned), 13mb total:"
    - "L1                                                                                                                 "
    - "L1.?[57213,79424] 10ns 10mb|--------------------------------L1.?--------------------------------|                    "
    - "L1.?[79425,85768] 10ns 3mb                                                                      |------L1.?-------| "
    - "Committing partition 1:"
    - "  Soft Deleting 10 files: L0.13, L0.20, L0.27, L0.34, L0.41, L0.48, L0.55, L0.62, L0.69, L0.76"
    - "  Creating 2 files"
    - "**** Simulation run 13, type=split(CompactAndSplitOutput(TotalSizeLessThanMaxCompactSize))(split_times=[107980]). 10 Input Files, 13mb total:"
    - "L0, all files 1mb                                                                                                  "
    - "L0.77[85769,114324] 10ns |-----------------------------------------L0.77------------------------------------------|"
    - "L0.70[85769,114324] 9ns  |-----------------------------------------L0.70------------------------------------------|"
    - "L0.63[85769,114324] 8ns  |-----------------------------------------L0.63------------------------------------------|"
    - "L0.56[85769,114324] 7ns  |-----------------------------------------L0.56------------------------------------------|"
    - "L0.49[85769,114324] 6ns  |-----------------------------------------L0.49------------------------------------------|"
    - "L0.42[85769,114324] 5ns  |-----------------------------------------L0.42------------------------------------------|"
    - "L0.35[85769,114324] 4ns  |-----------------------------------------L0.35------------------------------------------|"
    - "L0.28[85769,114324] 3ns  |-----------------------------------------L0.28------------------------------------------|"
    - "L0.21[85769,114324] 2ns  |-----------------------------------------L0.21------------------------------------------|"
    - "L0.14[85769,114324] 1ns  |-----------------------------------------L0.14------------------------------------------|"
    - "**** 2 Output Files (parquet_file_id not yet assigned), 13mb total:"
    - "L1                                                                                                                 "
    - "L1.?[85769,107980] 10ns 10mb|--------------------------------L1.?--------------------------------|                    "
    - "L1.?[107981,114324] 10ns 3mb                                                                      |------L1.?-------| "
    - "Committing partition 1:"
    - "  Soft Deleting 10 files: L0.14, L0.21, L0.28, L0.35, L0.42, L0.49, L0.56, L0.63, L0.70, L0.77"
    - "  Creating 2 files"
    - "**** Simulation run 14, type=split(CompactAndSplitOutput(TotalSizeLessThanMaxCompactSize))(split_times=[136536]). 10 Input Files, 13mb total:"
    - "L0, all files 1mb                                                                                                  "
    - "L0.78[114325,142880] 10ns|-----------------------------------------L0.78------------------------------------------|"
    - "L0.71[114325,142880] 9ns |-----------------------------------------L0.71------------------------------------------|"
    - "L0.64[114325,142880] 8ns |-----------------------------------------L0.64------------------------------------------|"
    - "L0.57[114325,142880] 7ns |-----------------------------------------L0.57------------------------------------------|"
    - "L0.50[114325,142880] 6ns |-----------------------------------------L0.50------------------------------------------|"
    - "L0.43[114325,142880] 5ns |-----------------------------------------L0.43------------------------------------------|"
    - "L0.36[114325,142880] 4ns |-----------------------------------------L0.36------------------------------------------|"
    - "L0.29[114325,142880] 3ns |-----------------------------------------L0.29------------------------------------------|"
    - "L0.22[114325,142880] 2ns |-----------------------------------------L0.22------------------------------------------|"
    - "L0.15[114325,142880] 1ns |-----------------------------------------L0.15------------------------------------------|"
    - "**** 2 Output Files (parquet_file_id not yet assigned), 13mb total:"
    - "L1                                                                                                                 "
    - "L1.?[114325,136536] 10ns 10mb|--------------------------------L1.?--------------------------------|                    "
    - "L1.?[136537,142880] 10ns 3mb                                                                      |------L1.?-------| "
    - "Committing partition 1:"
    - "  Soft Deleting 10 files: L0.15, L0.22, L0.29, L0.36, L0.43, L0.50, L0.57, L0.64, L0.71, L0.78"
    - "  Creating 2 files"
    - "**** Simulation run 15, type=split(CompactAndSplitOutput(TotalSizeLessThanMaxCompactSize))(split_times=[165092]). 10 Input Files, 13mb total:"
    - "L0, all files 1mb                                                                                                  "
    - "L0.79[142881,171436] 10ns|-----------------------------------------L0.79------------------------------------------|"
    - "L0.72[142881,171436] 9ns |-----------------------------------------L0.72------------------------------------------|"
    - "L0.65[142881,171436] 8ns |-----------------------------------------L0.65------------------------------------------|"
    - "L0.58[142881,171436] 7ns |-----------------------------------------L0.58------------------------------------------|"
    - "L0.51[142881,171436] 6ns |-----------------------------------------L0.51------------------------------------------|"
    - "L0.44[142881,171436] 5ns |-----------------------------------------L0.44------------------------------------------|"
    - "L0.37[142881,171436] 4ns |-----------------------------------------L0.37------------------------------------------|"
    - "L0.30[142881,171436] 3ns |-----------------------------------------L0.30------------------------------------------|"
    - "L0.23[142881,171436] 2ns |-----------------------------------------L0.23------------------------------------------|"
    - "L0.16[142881,171436] 1ns |-----------------------------------------L0.16------------------------------------------|"
    - "**** 2 Output Files (parquet_file_id not yet assigned), 13mb total:"
    - "L1                                                                                                                 "
    - "L1.?[142881,165092] 10ns 10mb|--------------------------------L1.?--------------------------------|                    "
    - "L1.?[165093,171436] 10ns 3mb                                                                      |------L1.?-------| "
    - "Committing partition 1:"
    - "  Soft Deleting 10 files: L0.16, L0.23, L0.30, L0.37, L0.44, L0.51, L0.58, L0.65, L0.72, L0.79"
    - "  Creating 2 files"
    - "**** Simulation run 16, type=split(CompactAndSplitOutput(TotalSizeLessThanMaxCompactSize))(split_times=[193648]). 10 Input Files, 13mb total:"
    - "L0, all files 1mb                                                                                                  "
    - "L0.80[171437,200000] 10ns|-----------------------------------------L0.80------------------------------------------|"
    - "L0.73[171437,200000] 9ns |-----------------------------------------L0.73------------------------------------------|"
    - "L0.66[171437,200000] 8ns |-----------------------------------------L0.66------------------------------------------|"
    - "L0.59[171437,200000] 7ns |-----------------------------------------L0.59------------------------------------------|"
    - "L0.52[171437,200000] 6ns |-----------------------------------------L0.52------------------------------------------|"
    - "L0.45[171437,200000] 5ns |-----------------------------------------L0.45------------------------------------------|"
    - "L0.38[171437,200000] 4ns |-----------------------------------------L0.38------------------------------------------|"
    - "L0.31[171437,200000] 3ns |-----------------------------------------L0.31------------------------------------------|"
    - "L0.24[171437,200000] 2ns |-----------------------------------------L0.24------------------------------------------|"
    - "L0.17[171437,200000] 1ns |-----------------------------------------L0.17------------------------------------------|"
    - "**** 2 Output Files (parquet_file_id not yet assigned), 13mb total:"
    - "L1                                                                                                                 "
    - "L1.?[171437,193648] 10ns 10mb|-------------------------------L1.?--------------------------------|                     "
    - "L1.?[193649,200000] 10ns 3mb                                                                     |-------L1.?-------| "
    - "Committing partition 1:"
    - "  Soft Deleting 10 files: L0.17, L0.24, L0.31, L0.38, L0.45, L0.52, L0.59, L0.66, L0.73, L0.80"
    - "  Creating 2 files"
    - "**** Simulation run 17, type=split(CompactAndSplitOutput(FoundSubsetLessThanMaxCompactSize))(split_times=[44523, 66734]). 5 Input Files, 29mb total:"
    - "L1                                                                                                                 "
    - "L1.82[22312,28656] 10ns 3mb|L1.82-|                                                                                  "
    - "L1.83[28657,50868] 10ns 10mb        |------------L1.83------------|                                                   "
    - "L1.84[50869,57212] 10ns 3mb                                        |L1.84-|                                          "
    - "L1.85[57213,79424] 10ns 10mb                                                 |------------L1.85------------|          "
    - "L1.86[79425,85768] 10ns 3mb                                                                                 |L1.86-| "
    - "**** 3 Output Files (parquet_file_id not yet assigned), 29mb total:"
    - "L2                                                                                                                 "
    - "L2.?[22312,44523] 10ns 10mb|------------L2.?-------------|                                                           "
    - "L2.?[44524,66734] 10ns 10mb                               |------------L2.?-------------|                            "
    - "L2.?[66735,85768] 10ns 9mb                                                               |----------L2.?----------| "
    - "Committing partition 1:"
    - "  Soft Deleting 5 files: L1.82, L1.83, L1.84, L1.85, L1.86"
    - "  Upgrading 1 files level to CompactionLevel::L2: L1.81"
    - "  Creating 3 files"
    - "**** Simulation run 18, type=split(CompactAndSplitOutput(FoundSubsetLessThanMaxCompactSize))(split_times=[130192, 152403]). 5 Input Files, 29mb total:"
    - "L1                                                                                                                 "
    - "L1.88[107981,114324] 10ns 3mb|L1.88-|                                                                                  "
    - "L1.89[114325,136536] 10ns 10mb        |------------L1.89------------|                                                   "
    - "L1.90[136537,142880] 10ns 3mb                                        |L1.90-|                                          "
    - "L1.91[142881,165092] 10ns 10mb                                                 |------------L1.91------------|          "
    - "L1.92[165093,171436] 10ns 3mb                                                                                 |L1.92-| "
    - "**** 3 Output Files (parquet_file_id not yet assigned), 29mb total:"
    - "L2                                                                                                                 "
    - "L2.?[107981,130192] 10ns 10mb|------------L2.?-------------|                                                           "
    - "L2.?[130193,152403] 10ns 10mb                               |------------L2.?-------------|                            "
    - "L2.?[152404,171436] 10ns 9mb                                                               |----------L2.?----------| "
    - "Committing partition 1:"
    - "  Soft Deleting 5 files: L1.88, L1.89, L1.90, L1.91, L1.92"
    - "  Upgrading 1 files level to CompactionLevel::L2: L1.87"
    - "  Creating 3 files"
    - "**** Simulation run 19, type=split(CompactAndSplitOutput(TotalSizeLessThanMaxCompactSize))(split_times=[198729]). 1 Input Files, 3mb total:"
    - "L1, all files 3mb                                                                                                  "
    - "L1.94[193649,200000] 10ns|-----------------------------------------L1.94------------------------------------------|"
    - "**** 2 Output Files (parquet_file_id not yet assigned), 3mb total:"
    - "L2                                                                                                                 "
    - "L2.?[193649,198729] 10ns 2mb|--------------------------------L2.?---------------------------------|                   "
    - "L2.?[198730,200000] 10ns 586kb                                                                        |-----L2.?------| "
    - "Committing partition 1:"
    - "  Soft Deleting 1 files: L1.94"
    - "  Upgrading 1 files level to CompactionLevel::L2: L1.93"
    - "  Creating 2 files"
    - "**** Final Output Files (240mb written)"
    - "L2                                                                                                                 "
    - "L2.81[100,22311] 10ns 10mb|-L2.81-|                                                                                 "
    - "L2.87[85769,107980] 10ns 10mb                                      |-L2.87-|                                           "
    - "L2.93[171437,193648] 10ns 10mb                                                                             |-L2.93-|    "
    - "L2.95[22312,44523] 10ns 10mb          |-L2.95-|                                                                       "
    - "L2.96[44524,66734] 10ns 10mb                    |-L2.96-|                                                             "
    - "L2.97[66735,85768] 10ns 9mb                              |L2.97-|                                                    "
    - "L2.98[107981,130192] 10ns 10mb                                                |-L2.98-|                                 "
    - "L2.99[130193,152403] 10ns 10mb                                                          |-L2.99-|                       "
    - "L2.100[152404,171436] 10ns 9mb                                                                    |L2.100|              "
    - "L2.101[193649,198729] 10ns 2mb                                                                                       |L2.101|"
    - "L2.102[198730,200000] 10ns 586kb                                                                                         |L2.102|"
    "###
    );
}

#[tokio::test]
async fn all_overlapping_l0_max_input_bytes_per_partition_small_max_desired_file_size() {
    test_helpers::maybe_start_logging();

    // limit the plan to combining 30 mb at a time
    let setup = layout_setup_builder()
        .await
        .with_max_desired_file_size_bytes(10 * ONE_MB)
        .build()
        .await;

    // create virtual files
    let setup = all_overlapping_l0_files(setup).await;

    // expect that each plan the compactor runs has at most three input files
    insta::assert_yaml_snapshot!(
        run_layout_scenario(&setup).await,
        @r###"
    ---
    - "**** Input Files "
    - "L0, all files 9mb                                                                                                  "
    - "L0.1[100,200000] 1ns     |-----------------------------------------L0.1------------------------------------------| "
    - "L0.2[100,200000] 2ns     |-----------------------------------------L0.2------------------------------------------| "
    - "L0.3[100,200000] 3ns     |-----------------------------------------L0.3------------------------------------------| "
    - "L0.4[100,200000] 4ns     |-----------------------------------------L0.4------------------------------------------| "
    - "L0.5[100,200000] 5ns     |-----------------------------------------L0.5------------------------------------------| "
    - "L0.6[100,200000] 6ns     |-----------------------------------------L0.6------------------------------------------| "
    - "L0.7[100,200000] 7ns     |-----------------------------------------L0.7------------------------------------------| "
    - "L0.8[100,200000] 8ns     |-----------------------------------------L0.8------------------------------------------| "
    - "L0.9[100,200000] 9ns     |-----------------------------------------L0.9------------------------------------------| "
    - "L0.10[100,200000] 10ns   |-----------------------------------------L0.10-----------------------------------------| "
    - "**** Simulation run 0, type=split(VerticalSplit)(split_times=[28656, 57212, 85768, 114324, 142880, 171436]). 1 Input Files, 9mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.1[100,200000] 1ns     |-----------------------------------------L0.1------------------------------------------| "
    - "**** 7 Output Files (parquet_file_id not yet assigned), 9mb total:"
    - "L0                                                                                                                 "
    - "L0.?[100,28656] 1ns 1mb  |---L0.?---|                                                                              "
    - "L0.?[28657,57212] 1ns 1mb            |---L0.?---|                                                                  "
    - "L0.?[57213,85768] 1ns 1mb                         |---L0.?---|                                                     "
    - "L0.?[85769,114324] 1ns 1mb                                      |---L0.?---|                                        "
    - "L0.?[114325,142880] 1ns 1mb                                                   |---L0.?---|                           "
    - "L0.?[142881,171436] 1ns 1mb                                                                |---L0.?---|              "
    - "L0.?[171437,200000] 1ns 1mb                                                                             |---L0.?---| "
    - "**** Simulation run 1, type=split(VerticalSplit)(split_times=[28656, 57212, 85768, 114324, 142880, 171436]). 1 Input Files, 9mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.2[100,200000] 2ns     |-----------------------------------------L0.2------------------------------------------| "
    - "**** 7 Output Files (parquet_file_id not yet assigned), 9mb total:"
    - "L0                                                                                                                 "
    - "L0.?[100,28656] 2ns 1mb  |---L0.?---|                                                                              "
    - "L0.?[28657,57212] 2ns 1mb            |---L0.?---|                                                                  "
    - "L0.?[57213,85768] 2ns 1mb                         |---L0.?---|                                                     "
    - "L0.?[85769,114324] 2ns 1mb                                      |---L0.?---|                                        "
    - "L0.?[114325,142880] 2ns 1mb                                                   |---L0.?---|                           "
    - "L0.?[142881,171436] 2ns 1mb                                                                |---L0.?---|              "
    - "L0.?[171437,200000] 2ns 1mb                                                                             |---L0.?---| "
    - "**** Simulation run 2, type=split(VerticalSplit)(split_times=[28656, 57212, 85768, 114324, 142880, 171436]). 1 Input Files, 9mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.3[100,200000] 3ns     |-----------------------------------------L0.3------------------------------------------| "
    - "**** 7 Output Files (parquet_file_id not yet assigned), 9mb total:"
    - "L0                                                                                                                 "
    - "L0.?[100,28656] 3ns 1mb  |---L0.?---|                                                                              "
    - "L0.?[28657,57212] 3ns 1mb            |---L0.?---|                                                                  "
    - "L0.?[57213,85768] 3ns 1mb                         |---L0.?---|                                                     "
    - "L0.?[85769,114324] 3ns 1mb                                      |---L0.?---|                                        "
    - "L0.?[114325,142880] 3ns 1mb                                                   |---L0.?---|                           "
    - "L0.?[142881,171436] 3ns 1mb                                                                |---L0.?---|              "
    - "L0.?[171437,200000] 3ns 1mb                                                                             |---L0.?---| "
    - "**** Simulation run 3, type=split(VerticalSplit)(split_times=[28656, 57212, 85768, 114324, 142880, 171436]). 1 Input Files, 9mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.4[100,200000] 4ns     |-----------------------------------------L0.4------------------------------------------| "
    - "**** 7 Output Files (parquet_file_id not yet assigned), 9mb total:"
    - "L0                                                                                                                 "
    - "L0.?[100,28656] 4ns 1mb  |---L0.?---|                                                                              "
    - "L0.?[28657,57212] 4ns 1mb            |---L0.?---|                                                                  "
    - "L0.?[57213,85768] 4ns 1mb                         |---L0.?---|                                                     "
    - "L0.?[85769,114324] 4ns 1mb                                      |---L0.?---|                                        "
    - "L0.?[114325,142880] 4ns 1mb                                                   |---L0.?---|                           "
    - "L0.?[142881,171436] 4ns 1mb                                                                |---L0.?---|              "
    - "L0.?[171437,200000] 4ns 1mb                                                                             |---L0.?---| "
    - "**** Simulation run 4, type=split(VerticalSplit)(split_times=[28656, 57212, 85768, 114324, 142880, 171436]). 1 Input Files, 9mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.5[100,200000] 5ns     |-----------------------------------------L0.5------------------------------------------| "
    - "**** 7 Output Files (parquet_file_id not yet assigned), 9mb total:"
    - "L0                                                                                                                 "
    - "L0.?[100,28656] 5ns 1mb  |---L0.?---|                                                                              "
    - "L0.?[28657,57212] 5ns 1mb            |---L0.?---|                                                                  "
    - "L0.?[57213,85768] 5ns 1mb                         |---L0.?---|                                                     "
    - "L0.?[85769,114324] 5ns 1mb                                      |---L0.?---|                                        "
    - "L0.?[114325,142880] 5ns 1mb                                                   |---L0.?---|                           "
    - "L0.?[142881,171436] 5ns 1mb                                                                |---L0.?---|              "
    - "L0.?[171437,200000] 5ns 1mb                                                                             |---L0.?---| "
    - "**** Simulation run 5, type=split(VerticalSplit)(split_times=[28656, 57212, 85768, 114324, 142880, 171436]). 1 Input Files, 9mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.6[100,200000] 6ns     |-----------------------------------------L0.6------------------------------------------| "
    - "**** 7 Output Files (parquet_file_id not yet assigned), 9mb total:"
    - "L0                                                                                                                 "
    - "L0.?[100,28656] 6ns 1mb  |---L0.?---|                                                                              "
    - "L0.?[28657,57212] 6ns 1mb            |---L0.?---|                                                                  "
    - "L0.?[57213,85768] 6ns 1mb                         |---L0.?---|                                                     "
    - "L0.?[85769,114324] 6ns 1mb                                      |---L0.?---|                                        "
    - "L0.?[114325,142880] 6ns 1mb                                                   |---L0.?---|                           "
    - "L0.?[142881,171436] 6ns 1mb                                                                |---L0.?---|              "
    - "L0.?[171437,200000] 6ns 1mb                                                                             |---L0.?---| "
    - "**** Simulation run 6, type=split(VerticalSplit)(split_times=[28656, 57212, 85768, 114324, 142880, 171436]). 1 Input Files, 9mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.7[100,200000] 7ns     |-----------------------------------------L0.7------------------------------------------| "
    - "**** 7 Output Files (parquet_file_id not yet assigned), 9mb total:"
    - "L0                                                                                                                 "
    - "L0.?[100,28656] 7ns 1mb  |---L0.?---|                                                                              "
    - "L0.?[28657,57212] 7ns 1mb            |---L0.?---|                                                                  "
    - "L0.?[57213,85768] 7ns 1mb                         |---L0.?---|                                                     "
    - "L0.?[85769,114324] 7ns 1mb                                      |---L0.?---|                                        "
    - "L0.?[114325,142880] 7ns 1mb                                                   |---L0.?---|                           "
    - "L0.?[142881,171436] 7ns 1mb                                                                |---L0.?---|              "
    - "L0.?[171437,200000] 7ns 1mb                                                                             |---L0.?---| "
    - "**** Simulation run 7, type=split(VerticalSplit)(split_times=[28656, 57212, 85768, 114324, 142880, 171436]). 1 Input Files, 9mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.8[100,200000] 8ns     |-----------------------------------------L0.8------------------------------------------| "
    - "**** 7 Output Files (parquet_file_id not yet assigned), 9mb total:"
    - "L0                                                                                                                 "
    - "L0.?[100,28656] 8ns 1mb  |---L0.?---|                                                                              "
    - "L0.?[28657,57212] 8ns 1mb            |---L0.?---|                                                                  "
    - "L0.?[57213,85768] 8ns 1mb                         |---L0.?---|                                                     "
    - "L0.?[85769,114324] 8ns 1mb                                      |---L0.?---|                                        "
    - "L0.?[114325,142880] 8ns 1mb                                                   |---L0.?---|                           "
    - "L0.?[142881,171436] 8ns 1mb                                                                |---L0.?---|              "
    - "L0.?[171437,200000] 8ns 1mb                                                                             |---L0.?---| "
    - "**** Simulation run 8, type=split(VerticalSplit)(split_times=[28656, 57212, 85768, 114324, 142880, 171436]). 1 Input Files, 9mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.9[100,200000] 9ns     |-----------------------------------------L0.9------------------------------------------| "
    - "**** 7 Output Files (parquet_file_id not yet assigned), 9mb total:"
    - "L0                                                                                                                 "
    - "L0.?[100,28656] 9ns 1mb  |---L0.?---|                                                                              "
    - "L0.?[28657,57212] 9ns 1mb            |---L0.?---|                                                                  "
    - "L0.?[57213,85768] 9ns 1mb                         |---L0.?---|                                                     "
    - "L0.?[85769,114324] 9ns 1mb                                      |---L0.?---|                                        "
    - "L0.?[114325,142880] 9ns 1mb                                                   |---L0.?---|                           "
    - "L0.?[142881,171436] 9ns 1mb                                                                |---L0.?---|              "
    - "L0.?[171437,200000] 9ns 1mb                                                                             |---L0.?---| "
    - "**** Simulation run 9, type=split(VerticalSplit)(split_times=[28656, 57212, 85768, 114324, 142880, 171436]). 1 Input Files, 9mb total:"
    - "L0, all files 9mb                                                                                                  "
    - "L0.10[100,200000] 10ns   |-----------------------------------------L0.10-----------------------------------------| "
    - "**** 7 Output Files (parquet_file_id not yet assigned), 9mb total:"
    - "L0                                                                                                                 "
    - "L0.?[100,28656] 10ns 1mb |---L0.?---|                                                                              "
    - "L0.?[28657,57212] 10ns 1mb            |---L0.?---|                                                                  "
    - "L0.?[57213,85768] 10ns 1mb                         |---L0.?---|                                                     "
    - "L0.?[85769,114324] 10ns 1mb                                      |---L0.?---|                                        "
    - "L0.?[114325,142880] 10ns 1mb                                                   |---L0.?---|                           "
    - "L0.?[142881,171436] 10ns 1mb                                                                |---L0.?---|              "
    - "L0.?[171437,200000] 10ns 1mb                                                                             |---L0.?---| "
    - "Committing partition 1:"
    - "  Soft Deleting 10 files: L0.1, L0.2, L0.3, L0.4, L0.5, L0.6, L0.7, L0.8, L0.9, L0.10"
    - "  Creating 70 files"
    - "**** Simulation run 10, type=split(CompactAndSplitOutput(TotalSizeLessThanMaxCompactSize))(split_times=[22311]). 10 Input Files, 13mb total:"
    - "L0, all files 1mb                                                                                                  "
    - "L0.74[100,28656] 10ns    |-----------------------------------------L0.74------------------------------------------|"
    - "L0.67[100,28656] 9ns     |-----------------------------------------L0.67------------------------------------------|"
    - "L0.60[100,28656] 8ns     |-----------------------------------------L0.60------------------------------------------|"
    - "L0.53[100,28656] 7ns     |-----------------------------------------L0.53------------------------------------------|"
    - "L0.46[100,28656] 6ns     |-----------------------------------------L0.46------------------------------------------|"
    - "L0.39[100,28656] 5ns     |-----------------------------------------L0.39------------------------------------------|"
    - "L0.32[100,28656] 4ns     |-----------------------------------------L0.32------------------------------------------|"
    - "L0.25[100,28656] 3ns     |-----------------------------------------L0.25------------------------------------------|"
    - "L0.18[100,28656] 2ns     |-----------------------------------------L0.18------------------------------------------|"
    - "L0.11[100,28656] 1ns     |-----------------------------------------L0.11------------------------------------------|"
    - "**** 2 Output Files (parquet_file_id not yet assigned), 13mb total:"
    - "L1                                                                                                                 "
    - "L1.?[100,22311] 10ns 10mb|--------------------------------L1.?--------------------------------|                    "
    - "L1.?[22312,28656] 10ns 3mb                                                                      |------L1.?-------| "
    - "Committing partition 1:"
    - "  Soft Deleting 10 files: L0.11, L0.18, L0.25, L0.32, L0.39, L0.46, L0.53, L0.60, L0.67, L0.74"
    - "  Creating 2 files"
    - "**** Simulation run 11, type=split(CompactAndSplitOutput(TotalSizeLessThanMaxCompactSize))(split_times=[50868]). 10 Input Files, 13mb total:"
    - "L0, all files 1mb                                                                                                  "
    - "L0.75[28657,57212] 10ns  |-----------------------------------------L0.75------------------------------------------|"
    - "L0.68[28657,57212] 9ns   |-----------------------------------------L0.68------------------------------------------|"
    - "L0.61[28657,57212] 8ns   |-----------------------------------------L0.61------------------------------------------|"
    - "L0.54[28657,57212] 7ns   |-----------------------------------------L0.54------------------------------------------|"
    - "L0.47[28657,57212] 6ns   |-----------------------------------------L0.47------------------------------------------|"
    - "L0.40[28657,57212] 5ns   |-----------------------------------------L0.40------------------------------------------|"
    - "L0.33[28657,57212] 4ns   |-----------------------------------------L0.33------------------------------------------|"
    - "L0.26[28657,57212] 3ns   |-----------------------------------------L0.26------------------------------------------|"
    - "L0.19[28657,57212] 2ns   |-----------------------------------------L0.19------------------------------------------|"
    - "L0.12[28657,57212] 1ns   |-----------------------------------------L0.12------------------------------------------|"
    - "**** 2 Output Files (parquet_file_id not yet assigned), 13mb total:"
    - "L1                                                                                                                 "
    - "L1.?[28657,50868] 10ns 10mb|--------------------------------L1.?--------------------------------|                    "
    - "L1.?[50869,57212] 10ns 3mb                                                                      |------L1.?-------| "
    - "Committing partition 1:"
    - "  Soft Deleting 10 files: L0.12, L0.19, L0.26, L0.33, L0.40, L0.47, L0.54, L0.61, L0.68, L0.75"
    - "  Creating 2 files"
    - "**** Simulation run 12, type=split(CompactAndSplitOutput(TotalSizeLessThanMaxCompactSize))(split_times=[79424]). 10 Input Files, 13mb total:"
    - "L0, all files 1mb                                                                                                  "
    - "L0.76[57213,85768] 10ns  |-----------------------------------------L0.76------------------------------------------|"
    - "L0.69[57213,85768] 9ns   |-----------------------------------------L0.69------------------------------------------|"
    - "L0.62[57213,85768] 8ns   |-----------------------------------------L0.62------------------------------------------|"
    - "L0.55[57213,85768] 7ns   |-----------------------------------------L0.55------------------------------------------|"
    - "L0.48[57213,85768] 6ns   |-----------------------------------------L0.48------------------------------------------|"
    - "L0.41[57213,85768] 5ns   |-----------------------------------------L0.41------------------------------------------|"
    - "L0.34[57213,85768] 4ns   |-----------------------------------------L0.34------------------------------------------|"
    - "L0.27[57213,85768] 3ns   |-----------------------------------------L0.27------------------------------------------|"
    - "L0.20[57213,85768] 2ns   |-----------------------------------------L0.20------------------------------------------|"
    - "L0.13[57213,85768] 1ns   |-----------------------------------------L0.13------------------------------------------|"
    - "**** 2 Output Files (parquet_file_id not yet assigned), 13mb total:"
    - "L1                                                                                                                 "
    - "L1.?[57213,79424] 10ns 10mb|--------------------------------L1.?--------------------------------|                    "
    - "L1.?[79425,85768] 10ns 3mb                                                                      |------L1.?-------| "
    - "Committing partition 1:"
    - "  Soft Deleting 10 files: L0.13, L0.20, L0.27, L0.34, L0.41, L0.48, L0.55, L0.62, L0.69, L0.76"
    - "  Creating 2 files"
    - "**** Simulation run 13, type=split(CompactAndSplitOutput(TotalSizeLessThanMaxCompactSize))(split_times=[107980]). 10 Input Files, 13mb total:"
    - "L0, all files 1mb                                                                                                  "
    - "L0.77[85769,114324] 10ns |-----------------------------------------L0.77------------------------------------------|"
    - "L0.70[85769,114324] 9ns  |-----------------------------------------L0.70------------------------------------------|"
    - "L0.63[85769,114324] 8ns  |-----------------------------------------L0.63------------------------------------------|"
    - "L0.56[85769,114324] 7ns  |-----------------------------------------L0.56------------------------------------------|"
    - "L0.49[85769,114324] 6ns  |-----------------------------------------L0.49------------------------------------------|"
    - "L0.42[85769,114324] 5ns  |-----------------------------------------L0.42------------------------------------------|"
    - "L0.35[85769,114324] 4ns  |-----------------------------------------L0.35------------------------------------------|"
    - "L0.28[85769,114324] 3ns  |-----------------------------------------L0.28------------------------------------------|"
    - "L0.21[85769,114324] 2ns  |-----------------------------------------L0.21------------------------------------------|"
    - "L0.14[85769,114324] 1ns  |-----------------------------------------L0.14------------------------------------------|"
    - "**** 2 Output Files (parquet_file_id not yet assigned), 13mb total:"
    - "L1                                                                                                                 "
    - "L1.?[85769,107980] 10ns 10mb|--------------------------------L1.?--------------------------------|                    "
    - "L1.?[107981,114324] 10ns 3mb                                                                      |------L1.?-------| "
    - "Committing partition 1:"
    - "  Soft Deleting 10 files: L0.14, L0.21, L0.28, L0.35, L0.42, L0.49, L0.56, L0.63, L0.70, L0.77"
    - "  Creating 2 files"
    - "**** Simulation run 14, type=split(CompactAndSplitOutput(TotalSizeLessThanMaxCompactSize))(split_times=[136536]). 10 Input Files, 13mb total:"
    - "L0, all files 1mb                                                                                                  "
    - "L0.78[114325,142880] 10ns|-----------------------------------------L0.78------------------------------------------|"
    - "L0.71[114325,142880] 9ns |-----------------------------------------L0.71------------------------------------------|"
    - "L0.64[114325,142880] 8ns |-----------------------------------------L0.64------------------------------------------|"
    - "L0.57[114325,142880] 7ns |-----------------------------------------L0.57------------------------------------------|"
    - "L0.50[114325,142880] 6ns |-----------------------------------------L0.50------------------------------------------|"
    - "L0.43[114325,142880] 5ns |-----------------------------------------L0.43------------------------------------------|"
    - "L0.36[114325,142880] 4ns |-----------------------------------------L0.36------------------------------------------|"
    - "L0.29[114325,142880] 3ns |-----------------------------------------L0.29------------------------------------------|"
    - "L0.22[114325,142880] 2ns |-----------------------------------------L0.22------------------------------------------|"
    - "L0.15[114325,142880] 1ns |-----------------------------------------L0.15------------------------------------------|"
    - "**** 2 Output Files (parquet_file_id not yet assigned), 13mb total:"
    - "L1                                                                                                                 "
    - "L1.?[114325,136536] 10ns 10mb|--------------------------------L1.?--------------------------------|                    "
    - "L1.?[136537,142880] 10ns 3mb                                                                      |------L1.?-------| "
    - "Committing partition 1:"
    - "  Soft Deleting 10 files: L0.15, L0.22, L0.29, L0.36, L0.43, L0.50, L0.57, L0.64, L0.71, L0.78"
    - "  Creating 2 files"
    - "**** Simulation run 15, type=split(CompactAndSplitOutput(TotalSizeLessThanMaxCompactSize))(split_times=[165092]). 10 Input Files, 13mb total:"
    - "L0, all files 1mb                                                                                                  "
    - "L0.79[142881,171436] 10ns|-----------------------------------------L0.79------------------------------------------|"
    - "L0.72[142881,171436] 9ns |-----------------------------------------L0.72------------------------------------------|"
    - "L0.65[142881,171436] 8ns |-----------------------------------------L0.65------------------------------------------|"
    - "L0.58[142881,171436] 7ns |-----------------------------------------L0.58------------------------------------------|"
    - "L0.51[142881,171436] 6ns |-----------------------------------------L0.51------------------------------------------|"
    - "L0.44[142881,171436] 5ns |-----------------------------------------L0.44------------------------------------------|"
    - "L0.37[142881,171436] 4ns |-----------------------------------------L0.37------------------------------------------|"
    - "L0.30[142881,171436] 3ns |-----------------------------------------L0.30------------------------------------------|"
    - "L0.23[142881,171436] 2ns |-----------------------------------------L0.23------------------------------------------|"
    - "L0.16[142881,171436] 1ns |-----------------------------------------L0.16------------------------------------------|"
    - "**** 2 Output Files (parquet_file_id not yet assigned), 13mb total:"
    - "L1                                                                                                                 "
    - "L1.?[142881,165092] 10ns 10mb|--------------------------------L1.?--------------------------------|                    "
    - "L1.?[165093,171436] 10ns 3mb                                                                      |------L1.?-------| "
    - "Committing partition 1:"
    - "  Soft Deleting 10 files: L0.16, L0.23, L0.30, L0.37, L0.44, L0.51, L0.58, L0.65, L0.72, L0.79"
    - "  Creating 2 files"
    - "**** Simulation run 16, type=split(CompactAndSplitOutput(TotalSizeLessThanMaxCompactSize))(split_times=[193648]). 10 Input Files, 13mb total:"
    - "L0, all files 1mb                                                                                                  "
    - "L0.80[171437,200000] 10ns|-----------------------------------------L0.80------------------------------------------|"
    - "L0.73[171437,200000] 9ns |-----------------------------------------L0.73------------------------------------------|"
    - "L0.66[171437,200000] 8ns |-----------------------------------------L0.66------------------------------------------|"
    - "L0.59[171437,200000] 7ns |-----------------------------------------L0.59------------------------------------------|"
    - "L0.52[171437,200000] 6ns |-----------------------------------------L0.52------------------------------------------|"
    - "L0.45[171437,200000] 5ns |-----------------------------------------L0.45------------------------------------------|"
    - "L0.38[171437,200000] 4ns |-----------------------------------------L0.38------------------------------------------|"
    - "L0.31[171437,200000] 3ns |-----------------------------------------L0.31------------------------------------------|"
    - "L0.24[171437,200000] 2ns |-----------------------------------------L0.24------------------------------------------|"
    - "L0.17[171437,200000] 1ns |-----------------------------------------L0.17------------------------------------------|"
    - "**** 2 Output Files (parquet_file_id not yet assigned), 13mb total:"
    - "L1                                                                                                                 "
    - "L1.?[171437,193648] 10ns 10mb|-------------------------------L1.?--------------------------------|                     "
    - "L1.?[193649,200000] 10ns 3mb                                                                     |-------L1.?-------| "
    - "Committing partition 1:"
    - "  Soft Deleting 10 files: L0.17, L0.24, L0.31, L0.38, L0.45, L0.52, L0.59, L0.66, L0.73, L0.80"
    - "  Creating 2 files"
    - "**** Simulation run 17, type=split(CompactAndSplitOutput(FoundSubsetLessThanMaxCompactSize))(split_times=[44523, 66734]). 5 Input Files, 29mb total:"
    - "L1                                                                                                                 "
    - "L1.82[22312,28656] 10ns 3mb|L1.82-|                                                                                  "
    - "L1.83[28657,50868] 10ns 10mb        |------------L1.83------------|                                                   "
    - "L1.84[50869,57212] 10ns 3mb                                        |L1.84-|                                          "
    - "L1.85[57213,79424] 10ns 10mb                                                 |------------L1.85------------|          "
    - "L1.86[79425,85768] 10ns 3mb                                                                                 |L1.86-| "
    - "**** 3 Output Files (parquet_file_id not yet assigned), 29mb total:"
    - "L2                                                                                                                 "
    - "L2.?[22312,44523] 10ns 10mb|------------L2.?-------------|                                                           "
    - "L2.?[44524,66734] 10ns 10mb                               |------------L2.?-------------|                            "
    - "L2.?[66735,85768] 10ns 9mb                                                               |----------L2.?----------| "
    - "Committing partition 1:"
    - "  Soft Deleting 5 files: L1.82, L1.83, L1.84, L1.85, L1.86"
    - "  Upgrading 1 files level to CompactionLevel::L2: L1.81"
    - "  Creating 3 files"
    - "**** Simulation run 18, type=split(CompactAndSplitOutput(FoundSubsetLessThanMaxCompactSize))(split_times=[130192, 152403]). 5 Input Files, 29mb total:"
    - "L1                                                                                                                 "
    - "L1.88[107981,114324] 10ns 3mb|L1.88-|                                                                                  "
    - "L1.89[114325,136536] 10ns 10mb        |------------L1.89------------|                                                   "
    - "L1.90[136537,142880] 10ns 3mb                                        |L1.90-|                                          "
    - "L1.91[142881,165092] 10ns 10mb                                                 |------------L1.91------------|          "
    - "L1.92[165093,171436] 10ns 3mb                                                                                 |L1.92-| "
    - "**** 3 Output Files (parquet_file_id not yet assigned), 29mb total:"
    - "L2                                                                                                                 "
    - "L2.?[107981,130192] 10ns 10mb|------------L2.?-------------|                                                           "
    - "L2.?[130193,152403] 10ns 10mb                               |------------L2.?-------------|                            "
    - "L2.?[152404,171436] 10ns 9mb                                                               |----------L2.?----------| "
    - "Committing partition 1:"
    - "  Soft Deleting 5 files: L1.88, L1.89, L1.90, L1.91, L1.92"
    - "  Upgrading 1 files level to CompactionLevel::L2: L1.87"
    - "  Creating 3 files"
    - "**** Simulation run 19, type=split(CompactAndSplitOutput(TotalSizeLessThanMaxCompactSize))(split_times=[198729]). 1 Input Files, 3mb total:"
    - "L1, all files 3mb                                                                                                  "
    - "L1.94[193649,200000] 10ns|-----------------------------------------L1.94------------------------------------------|"
    - "**** 2 Output Files (parquet_file_id not yet assigned), 3mb total:"
    - "L2                                                                                                                 "
    - "L2.?[193649,198729] 10ns 2mb|--------------------------------L2.?---------------------------------|                   "
    - "L2.?[198730,200000] 10ns 586kb                                                                        |-----L2.?------| "
    - "Committing partition 1:"
    - "  Soft Deleting 1 files: L1.94"
    - "  Upgrading 1 files level to CompactionLevel::L2: L1.93"
    - "  Creating 2 files"
    - "**** Final Output Files (240mb written)"
    - "L2                                                                                                                 "
    - "L2.81[100,22311] 10ns 10mb|-L2.81-|                                                                                 "
    - "L2.87[85769,107980] 10ns 10mb                                      |-L2.87-|                                           "
    - "L2.93[171437,193648] 10ns 10mb                                                                             |-L2.93-|    "
    - "L2.95[22312,44523] 10ns 10mb          |-L2.95-|                                                                       "
    - "L2.96[44524,66734] 10ns 10mb                    |-L2.96-|                                                             "
    - "L2.97[66735,85768] 10ns 9mb                              |L2.97-|                                                    "
    - "L2.98[107981,130192] 10ns 10mb                                                |-L2.98-|                                 "
    - "L2.99[130193,152403] 10ns 10mb                                                          |-L2.99-|                       "
    - "L2.100[152404,171436] 10ns 9mb                                                                    |L2.100|              "
    - "L2.101[193649,198729] 10ns 2mb                                                                                       |L2.101|"
    - "L2.102[198730,200000] 10ns 586kb                                                                                         |L2.102|"
    "###
    );
}
